
### 🛠️ 서명 식 간단 비교

#### 📌 ECDSA (개념적으로)
`s = k⁻¹ (H(m) + r * priv) mod n`

- `k`는 난수 (중복되면 X)
    
- `r`, `s`가 서명 값
    

#### 📌 EdDSA (Ed25519 기준)
`r = H(hash(sk)[32:] || m) R = r * B S = (r + H(R || A || m) * sk) mod L`


### 🛠️ 서명 과정 다이어그램

[개인키 SK] ──┬────────────┐
             │            │
             ▼            ▼
         [SHA-512]    [SHA-512 + 메시지]
             │            │
             ▼            ▼
           [a]          [r]
             │            │
             ▼            ▼
      ┌──────────────────────────────┐
      │ 공개키 A = a * B                           │
      │ 임시점  R = r * B                           │
      └──────────────────────────────┘
                      │
                      ▼
             [해시 H(R || A || m)]
                      │
                      ▼
      ┌────────────────────────────────────────┐
      │ 최종 서명값 S = r + H(R||A||m) * a mod L       │
      └────────────────────────────────────────┘



서명 단계

|단계|설명|
|---|---|
|`a = prune(SHA512(sk)[:32])`|개인키 `sk`로부터 곡선에서 사용할 **스칼라 a**를 만든다.|
|`A = a * B`|기본점 `B`를 기준으로 a배 → **공개키 A**|
|`r = SHA512(SHA512(sk)[32:]||
|`R = r * B`|이 `r`으로 점 `R`을 만든다.|
|`H = SHA512(R||
|`S = r + H * a (mod L)`|최종 서명값 계산|

최종 서명 = `(R, S)`  
검증할 때는 `R`, `A`, `m`, `S`를 이용해 `S * B == R + H * A` 인지를 확인함.

## 🧩 A, B, L 정리

| 기호    | 이름                | 설명                                                           |
| ----- | ----------------- | ------------------------------------------------------------ |
| **A** | 공개키 `A = a * B`   | 개인키로부터 생성된 **공개키**. 메시지와 함께 서명에 포함됨.                         |
| **B** | 기본 점 (base point) | 타원곡선 위의 **고정된 점**. 모든 키는 이 점을 기준으로 곱셈해서 생성됨.                 |
| **L** | 모듈러 값             | 순환 그룹의 **정수 계수의 차수(order)**, 즉 `L = order of B = 2²⁵² + ...` |
### 🔹 A (Public Key)

- 개인키 `sk`는 32바이트 시드임.
    
- 내부적으로는 `h = SHA512(sk)` → 하위 32바이트를 잘라서 `a`로 사용.
    
- 그 후:
    `A = a * B`
    
    여기서 `a`는 스칼라 (정수), `B`는 곡선의 기본점.
    

---

### 🔹 B (Base Point)

- **Twisted Edwards curve** (Ed25519)의 고정된 점
    
- 모든 키는 `k * B` 형태로 표현됨
    
- B는 사전에 정의된 값:
    
`B = (x, y) on curve: x ≈ 15112221349535400772501151409588531511454012693041857206046113283949847762202`

---

### 🔹 L (모듈러 연산 대상)

- L은 곡선 상에서 B의 **순환 차수(order)**

`L = 2²⁵² + 27742317777372353535851937790883648493`

즉, S 값을 이 `L`로 나눠서 정규화한다는 뜻이야.